"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8525],{3905:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>b});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var o=r.createContext({}),p=function(e){var n=r.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},s=function(e){var n=p(e.components);return r.createElement(o.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,o=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),d=p(t),m=a,b=d["".concat(o,".").concat(m)]||d[m]||u[m]||l;return t?r.createElement(b,c(c({ref:n},s),{},{components:t})):r.createElement(b,c({ref:n},s))}));function b(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,c=new Array(l);c[0]=m;var i={};for(var o in n)hasOwnProperty.call(n,o)&&(i[o]=n[o]);i.originalType=e,i[d]="string"==typeof e?e:a,c[1]=i;for(var p=2;p<l;p++)c[p]=t[p];return r.createElement.apply(null,c)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6433:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var r=t(7462),a=(t(7294),t(3905));const l={},c=void 0,i={unversionedId:"CABAL/\u81ea\u52a8\u66f4\u65b0WAN\u53e3IP",id:"CABAL/\u81ea\u52a8\u66f4\u65b0WAN\u53e3IP",title:"\u81ea\u52a8\u66f4\u65b0WAN\u53e3IP",description:"\u66f4\u65b0\u811a\u672c",source:"@site/docs/CABAL/\u81ea\u52a8\u66f4\u65b0WAN\u53e3IP.md",sourceDirName:"CABAL",slug:"/CABAL/\u81ea\u52a8\u66f4\u65b0WAN\u53e3IP",permalink:"/docs/CABAL/\u81ea\u52a8\u66f4\u65b0WAN\u53e3IP",draft:!1,editUrl:"https://github.com/divib-cc/divib-cc.github.io/docs/CABAL/\u81ea\u52a8\u66f4\u65b0WAN\u53e3IP.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CABAL\u6570\u636e\u5e93\u64cd\u4f5c\u4ee3\u7801",permalink:"/docs/CABAL/CABAL\u6570\u636e\u5e93\u64cd\u4f5c\u4ee3\u7801"},next:{title:"index",permalink:"/docs/"}},o={},p=[{value:"\u66f4\u65b0\u811a\u672c",id:"\u66f4\u65b0\u811a\u672c",level:3},{value:"\u5b9a\u65f6\u4efb\u52a1",id:"\u5b9a\u65f6\u4efb\u52a1",level:3}],s={toc:p};function d(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h3",{id:"\u66f4\u65b0\u811a\u672c"},"\u66f4\u65b0\u811a\u672c"),(0,a.kt)("p",null,"\u5b58\u653e\u4f4d\u7f6e",(0,a.kt)("inlineCode",{parentName:"p"},"/home/cabal/ip.sh")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/sh\n#\u83b7\u53d6WAN\u53e3\u516c\u7f51IP\nwan0=`curl icanhazip.com`\n#\u8bfb\u53d6WorldSvr_24_01.ini\u6587\u4ef6\u4e2d\u7684IPAddress\u7684IP\nwan1=`awk -F \'=\' \'/\\[WorldSvr\\]/{a=1}a==1&&$1~/IPAddress/{print $2;exit}\' /etc/cabal/WorldSvr_24_01.ini`\n\nif [ "$wan0" != "" ]\n    then\n        if [ "$wan0" == "$wan1" ]\n        then echo "WAN0"\n        exit\n        else echo "WAN1"\n        \n        sed /etc/cabal/Templates/WorldSvr_24_01.ini \\\n        -e "s/cip/$wan0/g" \\\n        > /etc/cabal/WorldSvr_24_01.ini.tmp\n        mv /etc/cabal/WorldSvr_24_01.ini.tmp /etc/cabal/WorldSvr_24_01.ini\n                \n        sed /etc/cabal/Templates/WorldSvr_24_02.ini \\\n        -e "s/cip/$wan0/g" \\\n        > /etc/cabal/WorldSvr_24_02.ini.tmp\n        mv /etc/cabal/WorldSvr_24_02.ini.tmp /etc/cabal/WorldSvr_24_02.ini\n                \n        sed /etc/cabal/Templates/WorldSvr_24_41.ini \\\n        -e "s/cip/$wan0/g" \\\n        > /etc/cabal/WorldSvr_24_41.ini.tmp\n        mv /etc/cabal/WorldSvr_24_41.ini.tmp /etc/cabal/WorldSvr_24_41.ini\n                \n        sed /etc/cabal/Templates/WorldSvr_24_43.ini \\\n        -e "s/cip/$wan0/g" \\\n        > /etc/cabal/WorldSvr_24_43.ini.tmp\n        mv /etc/cabal/WorldSvr_24_43.ini.tmp /etc/cabal/WorldSvr_24_43.ini\n        \n        sleep 5\n        /sbin/service cabal restart\n        exit\n        fi\n    else\n    exit\nfi\n')),(0,a.kt)("p",null,"\u4fdd\u5b58sh\u6587\u4ef6\u5e76\u7ed9\u6743\u9650"),(0,a.kt)("h3",{id:"\u5b9a\u65f6\u4efb\u52a1"},"\u5b9a\u65f6\u4efb\u52a1"),(0,a.kt)("p",null,"\u5728/etc/cron.d/copytodb_trc\u4e2d\u6dfb\u52a0"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"* * * * * root /home/cabal/ip.sh > /dev/null 2>&1\n")),(0,a.kt)("p",null,"\u67e5\u770bcrontab\u670d\u52a1\u72b6\u6001"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"/sbin/service crond status\n")),(0,a.kt)("p",null,"\u6ca1\u6709\u7684\u8bdd\u5c31\u5b89\u88c5cron\u670d\u52a1\n\u547d\u4ee4\u884c\u4e0b\u8f93\u5165"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get install cron\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"\u542f\u52a8\u4e0e\u5173\u95edcron\u670d\u52a1\n/sbin/service crond start \u542f\u52a8\u670d\u52a1\n/sbin/service crond stop \u5173\u95ed\u670d\u52a1\n/sbin/service crond restart \u91cd\u542f\u670d\u52a1\n/sbin/service crond reload \u91cd\u65b0\u8f7d\u5165\u914d\u7f6e\n/sbin/service crond status \u67e5\u770bcrontab\u670d\u52a1\u72b6\u6001\n")),(0,a.kt)("p",null,"\u7f16\u8f91\u5b9a\u65f6\u4efb\u52a1\ncrontab -e\n\u6309",(0,a.kt)("inlineCode",{parentName:"p"},"i"),"\u8fdb\u5165\u7f16\u8f91\n\u6309",(0,a.kt)("inlineCode",{parentName:"p"},"esc"),"\u9000\u51fa\u7f16\u8f91\n",(0,a.kt)("inlineCode",{parentName:"p"},"shift"),"+",(0,a.kt)("inlineCode",{parentName:"p"},":"),"\u8f93\u5165\u547d\u4ee4",(0,a.kt)("inlineCode",{parentName:"p"},"wq"),"\u4fdd\u5b58\u9000\u51fa\n\u6bcf1\u5206\u949f\u8fd0\u884c\u4e00\u6b21"),(0,a.kt)("p",null,"\u67e5\u770bcron\u4efb\u52a1"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"crontab -l\n")),(0,a.kt)("p",null,"\u67e5\u770bcron\u4efb\u52a1"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ps -ef|grep cabal\n")),(0,a.kt)("p",null,"\u67e5\u770bcron\u65e5\u5fd7"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"tail -f /var/log/cron\n")))}d.isMDXComponent=!0}}]);