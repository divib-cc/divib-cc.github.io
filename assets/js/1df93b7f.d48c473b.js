"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[4583],{3716:(t,e,n)=>{n.r(e),n.d(e,{default:()=>dt});var s=n(4164),i=n(6289),r=n(797),o=n(1410),a=n(9303);const c={heroBanner:"heroBanner_qdFl",buttons:"buttons_AeoN"};var u=n(6540),h=n(4922),l=n(9437),d=n(7024);var w=n(4667),f=n(8509);class p{actions={};currentAction=null;constructor(t,e){this.root=t,this.mixer=new h.Iw4(t),e.forEach((t=>{this.actions[t.name]=this.mixer.clipAction(t),this.actions[t.name].setEffectiveWeight(0)}))}autoPlayFirst(){const t=Object.values(this.actions)[0];t&&(this.currentAction=t,t.setEffectiveWeight(1).play())}crossFadeTo(t,e){const n=this.actions[t];n&&this.currentAction!==n&&(n.reset(),n.setEffectiveWeight(1),n.play(),this.currentAction&&(this.currentAction.enabled=!0,this.currentAction.crossFadeTo(n,e,!1)),this.currentAction=n)}update(t){this.mixer.update(t)}}var m=n(9070);const _=(t,e)=>{const n=b(t,e),s=new Uint8Array(t.buffer,e.n,n);return e.n+=n,(new TextDecoder).decode(s).replace(/\0.*$/g,"")};function b(t,e){const n=t.getUint16(e.n,!0);return e.n+=2,n}function g(t,e){const n=t.getUint32(e.n,!0);return e.n+=4,n}function x(t,e){const n=t.getFloat32(e.n,!0);return e.n+=4,n}function A(t,e){const n=t.getInt8(e.n);return e.n+=1,n}function v(t,e){const n=t.getInt16(e.n,!0);return e.n+=2,n}function y(t,e){const n=t.getInt32(e.n,!0);return e.n+=4,n}class E{constructor(t,e){this.x=x(t,e),this.y=x(t,e)}}class k{constructor(t,e){this.x=x(t,e),this.y=x(t,e),this.z=x(t,e)}}class T{col=[];constructor(t,e){for(let n=0;n<16;n++)this.col.push(x(t,e))}}class M{constructor(t,e){this.r=x(t,e),this.g=x(t,e),this.b=x(t,e),this.a=x(t,e)}}class I{constructor(t,e){this.b=A(t,e),this.g=A(t,e),this.r=A(t,e),this.a=A(t,e)}}var L=function(t){return t[t.MATERIAL=1095172609]="MATERIAL",t[t.MESH=1095172610]="MESH",t[t.ARMATURE=1095172611]="ARMATURE",t[t.ANIMATION=1095172612]="ANIMATION",t[t.INFLUENCE=1095172613]="INFLUENCE",t[t.MT2=547586304]="MT2",t}(L||{});class N{constructor(t){const e={n:0},n=t.byteLength;this.header=new R(t,e);do{switch(g(t,e)){case L.MATERIAL:this.mt=new z(t,e);break;case L.ARMATURE:this.sk=new q(t,e);break;case L.MESH:this.ge=new C(t,e,this.sk.count);break;case L.ANIMATION:this.an=new B(t,e);break;default:e.n-=4,this.gl=new Y(t,e)}}while(n-e.n>4)}}class R{constructor(t,e){this.unkb0=A(t,e),this.magic=b(t,e),this.unkb1=A(t,e),this.fileVersion=b(t,e);const n=function(t,e){const n=t.getUint8(e.n);return e.n+=1,n}(t,e);this.model_flag=new j(n),this.alpha_threshold=A(t,e),this.unkus1=b(t,e),this.bound_min=new k(t,e),this.bound_max=new k(t,e),this.scale_percentage=g(t,e)}}class j{constructor(t){this.unk_bit1=!!(128&t),this.unk_bit2=!!(64&t),this.additive_blend=!!(32&t),this.unk_bit3=!!(16&t),this.unk_bit4=!!(8&t),this.unk_bit5=!!(4&t),this.unk_bit6=!!(2&t),this.enable_alpha=!!(1&t)}}class z{materials=[];constructor(t,e){this.count=b(t,e);for(let n=0;n<this.count;n++)this.materials.push(new U(t,e))}}class U{constructor(t,e){this.material_properties=new S(t,e),this.texture=new F(t,e),this.layer=new W(t,e)}}class S{constructor(t,e){this.diffuse=new M(t,e),this.ambient=new M(t,e),this.specular=new M(t,e),this.emissive=new M(t,e),this.power=x(t,e)}}class F{constructor(t,e){this.id=_(t,e),this.size=y(t,e),this.data=((t,e,n)=>{const s=new Uint8Array(t.buffer,e.n,n);return e.n+=n,s})(t,e,this.size),this.is_faceted=!!A(t,e),this.scroll_speed=new E(t,e)}}class W{constructor(t,e){this.material_index=y(t,e),this.is_faceted=!!A(t,e),this.scroll_speed=new E(t,e),this.render_flags=y(t,e)}}class q{bones=[];constructor(t,e){this.count=b(t,e);for(let n=0;n<this.count;n++)this.bones.push(new P(t,e))}}class P{constructor(t,e){this.id=_(t,e),this.parent_bone_index=y(t,e),this.bone_space_matrix=new T(t,e),this.parent_bone_space_matrix=new T(t,e)}}class C{meshes=[];constructor(t,e,n){this.count=b(t,e);for(let s=0;s<this.count;s++)this.meshes.push(new H(t,e,n))}}class H{positions=[];normals=[];uvs=[];faces=[];influences=[];constructor(t,e,n){this.id=_(t,e),this.world_matrix=new T(t,e),this.local_matrix=new T(t,e),this.root_bone_id=y(t,e),this.material_index=A(t,e),this.vertex_count=v(t,e),this.face_count=v(t,e);for(let s=0;s<this.vertex_count;s++){for(let n=0;n<3;n++)this.positions.push(x(t,e));for(let n=0;n<3;n++)this.normals.push(x(t,e));for(let n=0;n<2;n++)this.uvs.push(x(t,e))}for(let s=0;s<3*this.face_count;s++)this.faces.push(b(t,e));this.chunk_id=g(t,e),this.influence_count=v(t,e);for(let s=0;s<this.influence_count;s++)this.influences.push(new D(t,e,n))}}class D{influence_for_bone=[];constructor(t,e,n){for(let s=0;s<n;s++)this.influence_for_bone.push(new O(t,e))}}class O{vertex_index=[];weight=[];constructor(t,e){this.count=y(t,e);for(let n=0;n<this.count;n++)this.vertex_index.push(y(t,e));for(let n=0;n<this.count;n++)this.weight.push(x(t,e))}}class B{animations=[];constructor(t,e){this.count=b(t,e);for(let n=0;n<this.count;n++)this.animations.push(new $(t,e))}}class ${transformations=[];constructor(t,e){this.id=_(t,e),this.count=b(t,e);for(let n=0;n<this.count;n++)this.transformations.push(new Q(t,e))}}class Q{translations=[];rotations=[];constructor(t,e){this.id=_(t,e),this.translation_count=g(t,e);for(let n=0;n<this.translation_count;n++)this.translations.push(new J(t,e));this.rotation_count=g(t,e);for(let n=0;n<this.rotation_count;n++)this.rotations.push(new K(t,e))}}class J{constructor(t,e){this.keyframe_second=x(t,e),this.position=new k(t,e)}}class K{constructor(t,e){this.keyframe_second=x(t,e),this.rotation=new V(t,e)}}class V{constructor(t,e){this.x=x(t,e),this.y=x(t,e),this.z=x(t,e),this.w=x(t,e)}}class Y{glow_colour=[];constructor(t,e){for(;t.byteLength-e.n>=4;)this.glow_colour.push(new I(t,e))}}var Z=function(t){return t[t.MATERIAL=1095172609]="MATERIAL",t[t.MESH=1095172610]="MESH",t[t.ARMATURE=1095172611]="ARMATURE",t[t.ANIMATION=1095172612]="ANIMATION",t[t.INFLUENCE=1095172613]="INFLUENCE",t[t.MT2=547586304]="MT2",t}(Z||{});new Set(Object.values(Z));class G{constructor(t){void 0===t&&(t=h.h_9),this.manager=t,this.fileLoader=new h.Y9S(t),this.fileLoader.setResponseType("arraybuffer")}load(t,e,n,s){this.fileLoader.load(t,(t=>{if(t instanceof ArrayBuffer)try{const n=this.parse(t);e(n)}catch(n){s?.(n)}else s?.(new Error("Invalid binary data"))}),n,s)}parse(t){const e=new DataView(t),n=new N(e);console.log(n);const s=new h.YJl,i=nt(n),r=X(n),o=tt(n,i,r);s.add(...o);const a=it(n,r);return s.animations=a,s}}const X=t=>{const e=[];return t.sk.bones.forEach((t=>{const{id:n,parent_bone_index:s,bone_space_matrix:i,parent_bone_space_matrix:r}=t,o=new h.$Kf;o.name=n;const a=(new h.kn4).fromArray(i.col).invert();if(o.matrix.copy(a),-1!==s){const t=(new h.kn4).fromArray(r.col).invert().multiply(a);o.matrix.copy(t),e[s].add(o)}o.matrix.decompose(o.position,o.quaternion,o.scale),e.push(o)})),new h.EAD(e)},tt=(t,e,n)=>t.ge.meshes.map((t=>{const{positions:s,normals:i,uvs:r,faces:o,influence_count:a,influences:c,material_index:u}=t,l=new h.LoY;let d;return l.setAttribute("position",new h.qtW(s,3)),l.setAttribute("normal",new h.qtW(i,3)),l.setAttribute("uv",new h.qtW(r,2)),l.setIndex(o),0===a?d=new h.eaF(l,e[u]):(d=new h.I46(l,e[u]),et(d,c,n)),d})),et=(t,e,n)=>{const s=n.bones.filter((t=>!(t.parent instanceof h.$Kf)));t.add(...s),t.bind(n);const i=[],r=[];e.forEach(((t,e)=>{t.influence_for_bone.forEach(((t,e)=>{t.vertex_index.forEach(((n,s)=>{const o=t.weight[s];i[n]||(i[n]=[],r[n]=[]),i[n].length<4&&(i[n].push(e),r[n].push(o))}))}))}));for(let o=0;o<i.length;o++)if(i[o].length<4)for(;i[o].length<4;)i[o].push(0),r[o].push(0);t.geometry.setAttribute("skinIndex",new h.A$4(i.flat(),4)),t.geometry.setAttribute("skinWeight",new h.qtW(r.flat(),4))},nt=t=>{const{materials:e}=t.mt;return e.map((t=>{const{diffuse:e,ambient:n,specular:s,emissive:i,power:r}=t.material_properties,o=st(t.texture.data);return new h.tXL({name:t.texture.id,map:o,color:new h.Q1f(e.r,e.g,e.b),opacity:e.a,transparent:e.a<1,specular:new h.Q1f(s.r,s.g,s.b),combine:h.KRh,reflectivity:s.a,emissive:new h.Q1f(i.r,i.g,i.b),emissiveIntensity:i.a,shininess:r,flatShading:t.texture.is_faceted})}))},st=t=>{const e=new m.T,n=new Blob([t],{type:"image/dds"}),s=URL.createObjectURL(n);return e.load(s,(()=>URL.revokeObjectURL(s)))},it=(t,e)=>t.an.animations.map((t=>{const n=[];return t.transformations.forEach((t=>{const s=e.bones.find((e=>e.name===t.id));if(!s)return;const i=s.parent?.matrixWorld||new h.kn4,r=new h.Pq0,o=new h.PTz,a=new h.Pq0;i.decompose(r,o,a);const c=rt(t.translations,s,i);c&&n.push(c);const u=ot(t.rotations,s,o);u&&n.push(u)})),new h.tz3(t.id,-1,n)})),rt=(t,e,n)=>{const s=t.map((t=>t.keyframe_second)),i=t.flatMap((t=>{const e=new h.Pq0(t.position.x,t.position.y,t.position.z).applyMatrix4(n.clone().invert());return[e.x,e.y,e.z]}));return new h.RiT(`${e.name}.position`,s,i)},ot=(t,e,n)=>{const s=t.map((t=>t.keyframe_second)),i=t.flatMap((t=>{const e=new h.PTz(t.rotation.x,t.rotation.y,t.rotation.z,t.rotation.w).conjugate();return n.clone().conjugate().multiply(e).toArray()}));return new h.MBL(`${e.name}.quaternion`,s,i)};var at=n(5363),ct=n(4848);const ut=()=>{const t=(0,u.useRef)(null),e=(0,u.useRef)(null),n=(0,u.useRef)(null),s=(0,u.useRef)(!1);return(0,u.useEffect)((()=>{if(!t.current)return;const{scene:i,camera:r,renderer:o,controls:a,dispose:c}=(t=>{const e=new h.Z58;e.background=new h.Q1f(14737632);const n=new h.ubm(55,window.innerWidth/window.innerHeight,1,2e3);n.position.set(0,200,500);const s=new l.JeP({canvas:t});s.setSize(window.innerWidth,window.innerHeight),s.toneMapping=h.FV,s.toneMappingExposure=.5;const i=new d.N(n,t),r=()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight)};return window.addEventListener("resize",r),{scene:e,camera:n,renderer:s,controls:i,dispose:()=>{window.removeEventListener("resize",r),s.dispose()}}})(t.current);n.current=((t,e)=>{const n={elevation:2,azimuth:180},s=new h.bdM(1e4,1e4),i=new w.E(s,{textureWidth:512,textureHeight:512,waterNormals:(new h.Tap).load("three/waternormals.jpg",(t=>{t.wrapS=t.wrapT=h.GJx})),sunDirection:new h.Pq0,sunColor:16777215,waterColor:7695,distortionScale:3.7,fog:void 0!==t.fog});i.rotation.x=-Math.PI/2,t.add(i);const r=new f.m;r.scale.setScalar(1e4),t.add(r);const o=new l.BdL(e),a=new h.Z58;let c=null;const u=()=>{const e=h.cj9.degToRad(90-n.elevation),s=h.cj9.degToRad(n.azimuth),u=(new h.Pq0).setFromSphericalCoords(1,e,s);r.material.uniforms.sunPosition.value.copy(u),i.material.uniforms.sunDirection.value.copy(u).normalize(),c&&c.dispose(),a.add(r),c=o.fromScene(a),t.add(r),t.environment=c.texture},d=new h.dth(16777215,9276813,3);d.position.set(0,20,0),t.add(d);const p=new h.ZyN(16777215,3);return p.position.set(0,20,10),t.add(p),u(),{water:i,sky:r,updateSun:u,parameters:n}})(i,o);(new G).load("./three/bike12.ebm",(t=>{i.add(t),e.current=new p(t,t.animations),e.current.autoPlayFirst()}));const u=()=>{s.current=!0,e.current?.crossFadeTo("move",.5)},m=()=>{s.current=!1,e.current?.crossFadeTo("idle",.5)};t.current.addEventListener("mousedown",u),window.addEventListener("mouseup",m);const _=new h.zD7,b=()=>{if(requestAnimationFrame(b),a.update(),n.current){n.current.water.material.uniforms.time.value+=1/60}e.current?.update(_.getDelta()),o.render(i,r)};return b(),()=>{t.current?.removeEventListener("mousedown",u),window.removeEventListener("mouseup",m),c(),n.current?.updateSun()}}),[]),(0,ct.jsx)("canvas",{ref:t,style:{width:"100%",height:"100vh"}})},ht=()=>(0,ct.jsx)("div",{style:{width:"100%",height:"100vh"},children:(0,ct.jsx)(at.A,{children:()=>(0,ct.jsx)(ut,{})})});function lt(){const{siteConfig:t}=(0,r.A)();return(0,ct.jsx)("header",{className:(0,s.A)("hero hero--primary",c.heroBanner),children:(0,ct.jsxs)("div",{className:"container",children:[(0,ct.jsx)(a.A,{as:"h1",className:"hero__title",children:t.title}),(0,ct.jsx)("p",{className:"hero__subtitle",children:t.tagline}),(0,ct.jsx)("div",{className:c.buttons,children:(0,ct.jsx)(i.A,{className:"button button--secondary button--lg",to:"/docs/intro",children:"Docusaurus Tutorial - 5min \u23f1\ufe0f"})})]})})}function dt(){const{siteConfig:t}=(0,r.A)();return(0,ct.jsxs)(o.A,{title:`Hello from ${t.title}`,description:"Description will go into a meta tag in <head />",children:[(0,ct.jsx)(lt,{}),(0,ct.jsx)("main",{style:{height:"720px"},children:(0,ct.jsx)(ht,{})})]})}}}]);